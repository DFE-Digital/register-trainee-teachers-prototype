{% extends "_templates/_page.html" %}

{% set navActive = "funding" %}
{% set backLink = 'false' %}

{% set filteredRecords = data.records | filterRecords(data) %}

{# Remaining trainees #}
{% set traineesThatCanBeRecommended = filteredRecords | filterByReadyToRecommend %}
{# {% set traineesThatCanBeRecommended = 0 %} #}

{# Sets numbers for errors summary #}
{% set errorCount     = data.bulkUpload.processedRows | where("uploadStatus", "error") | length  %}
{% set unchangedCount = data.bulkUpload.processedRows | where("uploadStatus", "unchanged") | length  %}
{% set updatedCount   = data.bulkUpload.processedRows | where("uploadStatus", "updated") | length  %}

{% set processedRows = data.bulkUpload.processedRows | where("uploadStatus", "updated") %}

{# Get an array of the trainees #}
{% set processedTrainees = processedRows | lodash("map", "trainee") %}

{% set pageHeading = "File uploaded successfully" %}


{% block content %}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-full-from-desktop">

    {% set html %}
    <h3 class="govuk-notification-banner__heading">
      File uploaded
    </h3>
    {% endset %}

    {{ govukNotificationBanner({
    html: html,
    type: "success"
    }) }}
    </div>

    <div class="govuk-grid-column-two-thirds-from-desktop">

      <form action="confirmation-upload" method="post" novalidate>

        <input name="successFlash" type="hidden" value="File uploaded">

        <div class="govuk-form-group">
          <label class="govuk-label" for="funding-month">
            Select applicable month
          </label>
          <div id="funding-month-hint" class="govuk-hint">
            Please select the month you are uploading funding information for.
          </div>
          <select class="govuk-select" id="funding-month" name="funding-month" aria-describedby="funding-month-hint">
            <option value="choose" selected>Choose month</option>
            <option value="january">January</option>
            <option value="february">February</option>
            <option value="march">March</option>
            <option value="april">April</option>
            <option value="may">May</option>
            <option value="june">June</option>
            <option value="july">July</option>
            <option value="august">August</option>
            <option value="september">September</option>
            <option value="october">October</option>
            <option value="november">November</option>
            <option value="december">December</option>
          </select>
        </div>

        <p class="govuk-body">
          Click 'Submit the data' button to publish this funding information.
        </p>

        {{ govukButton({
        "text": "Submit the data",
        href: "confirmation-processed.html"
        }) }}
      </form>

      <p class="govuk-body"><a href="index" class="govuk-link">Cancel and return to task list</a></p>

      {{data | log}}
    </div>
  </div>

{% endblock %}
